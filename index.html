<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TeamInsight - Dashboard</title>
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 min-h-screen">
  <div class="min-h-screen flex flex-col">
    <!-- ===== HEADER ===== -->
    <header class="bg-indigo-700 text-white px-6 py-4 flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-semibold tracking-tight">TeamInsight</h1>
        <p class="text-sm text-indigo-100">
          Monitoring student team dynamics for academic projects
        </p>
      </div>
      <div class="flex items-center gap-3">
        <div class="text-right">
          <p class="text-sm font-medium">Lecturer: Dr. Uzi Rosen</p>
          <p class="text-xs text-indigo-100">Course: Advanced Web Technologies (61776)</p>
        </div>
        <span class="inline-flex items-center rounded-full bg-indigo-500/80 px-3 py-1 text-xs">
          Semester: 2025A
        </span>
      </div>
    </header>

    <div class="flex flex-1">
      <!-- ===== SIDEBAR ===== -->
      <aside class="hidden md:block w-64 bg-white border-r border-slate-200 p-4">
        <nav class="space-y-1">
          <button
            class="w-full text-left px-3 py-2 rounded-lg text-sm font-medium hover:bg-indigo-50 data-[active=true]:bg-indigo-100 data-[active=true]:text-indigo-800"
            data-nav-btn
            data-target="screen-dashboard"
          >
            Dashboard
          </button>
          <button
            class="w-full text-left px-3 py-2 rounded-lg text-sm font-medium hover:bg-indigo-50 data-[active=true]:bg-indigo-100 data-[active=true]:text-indigo-800"
            data-nav-btn
            data-target="screen-teams"
          >
            Teams Overview
          </button>
          <button
            class="w-full text-left px-3 py-2 rounded-lg text-sm font-medium hover:bg-indigo-50 data-[active=true]:bg-indigo-100 data-[active=true]:text-indigo-800"
            data-nav-btn
            data-target="screen-bot"
          >
            Bot Reflection (Student view)
          </button>
        </nav>

        <div class="mt-6 border-t pt-4 text-xs text-slate-500">
          <p>Fake data demo for homework #1.</p>
          <p>Git: <span class="text-indigo-600 break-all">https://github.com/YairZen/WebTeam4</span></p>
        </div>
      </aside>

      <!-- ===== MAIN CONTENT ===== -->
      <main class="flex-1 p-4 md:p-6 space-y-6">
        <!-- ========== SCREEN: DASHBOARD ========== -->
        <section id="screen-dashboard" data-screen class="space-y-6">
          <!-- KPI cards -->
          <div class="grid gap-4 md:grid-cols-4">
            <div class="bg-white rounded-xl shadow-sm p-4 border border-slate-200">
              <p class="text-xs text-slate-500">Total teams</p>
              <p id="kpi-total-teams" class="mt-1 text-2xl font-semibold text-slate-900">0</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm p-4 border border-emerald-200">
              <p class="text-xs text-slate-500">Teams in green status</p>
              <p id="kpi-green-teams" class="mt-1 text-2xl font-semibold text-emerald-700">0</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm p-4 border border-amber-200">
              <p class="text-xs text-slate-500">Teams in yellow status</p>
              <p id="kpi-yellow-teams" class="mt-1 text-2xl font-semibold text-amber-600">0</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm p-4 border border-rose-200">
              <p class="text-xs text-slate-500">Teams in red status</p>
              <p id="kpi-red-teams" class="mt-1 text-2xl font-semibold text-rose-600">0</p>
            </div>
          </div>

          <!-- Status distribution ‚Äúgraph‚Äù -->
          <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4 md:p-5">
            <div class="flex items-center justify-between mb-3">
              <h2 class="text-sm font-semibold text-slate-800">
                Team status overview (traffic light)
              </h2>
              <span class="text-xs text-slate-500">Fake data ‚Äì weekly snapshot</span>
            </div>

            <div class="space-y-2">
              <div class="flex items-center justify-between text-xs text-slate-500">
                <span>Green (healthy)</span>
                <span id="label-green-percent">0%</span>
              </div>
              <div class="w-full h-3 rounded-full bg-slate-100 overflow-hidden">
                <div id="bar-green" class="h-3 bg-emerald-400"></div>
              </div>

              <div class="flex items-center justify-between text-xs text-slate-500">
                <span>Yellow (needs attention)</span>
                <span id="label-yellow-percent">0%</span>
              </div>
              <div class="w-full h-3 rounded-full bg-slate-100 overflow-hidden">
                <div id="bar-yellow" class="h-3 bg-amber-400"></div>
              </div>

              <div class="flex items-center justify-between text-xs text-slate-500">
                <span>Red (problematic)</span>
                <span id="label-red-percent">0%</span>
              </div>
              <div class="w-full h-3 rounded-full bg-slate-100 overflow-hidden">
                <div id="bar-red" class="h-3 bg-rose-400"></div>
              </div>
            </div>

            <p class="mt-4 text-xs text-slate-500">
              The system analyzes short reflections from students and calculates a
              simple team status (green / yellow / red) according to communication,
              load balance and detected conflicts.
            </p>
          </div>

          <!-- Sample trend for one team -->
          <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4 md:p-5">
            <h2 class="text-sm font-semibold text-slate-800 mb-3">
              Team TS-03 ‚Äì communication trend (fake weekly data)
            </h2>
            <div class="space-y-2">
              <!-- "Graph" made of bars, pure HTML/CSS -->
              <div class="flex items-end gap-2 h-24">
                <div class="flex-1 flex flex-col items-center">
                  <div class="w-6 rounded-t-md bg-slate-300" style="height: 40%;"></div>
                  <span class="text-[10px] mt-1 text-slate-500">Week 1</span>
                </div>
                <div class="flex-1 flex flex-col items-center">
                  <div class="w-6 rounded-t-md bg-slate-400" style="height: 55%;"></div>
                  <span class="text-[10px] mt-1 text-slate-500">Week 2</span>
                </div>
                <div class="flex-1 flex flex-col items-center">
                  <div class="w-6 rounded-t-md bg-amber-400" style="height: 70%;"></div>
                  <span class="text-[10px] mt-1 text-slate-500">Week 3</span>
                </div>
                <div class="flex-1 flex flex-col items-center">
                  <div class="w-6 rounded-t-md bg-rose-400" style="height: 85%;"></div>
                  <span class="text-[10px] mt-1 text-slate-500">Week 4</span>
                </div>
              </div>
              <p class="text-xs text-slate-500">
                Example: the bar height can represent ‚Äúrisk level‚Äù or ‚Äúcommunication issues‚Äù
                detected from weekly reflections.
              </p>
            </div>
          </div>
        </section>

        <!-- ========== SCREEN: TEAMS OVERVIEW ========== -->
        <section id="screen-teams" data-screen class="space-y-4 hidden">
          <div class="flex flex-wrap items-center justify-between gap-3">
            <div>
              <h2 class="text-lg font-semibold text-slate-800">Teams overview</h2>
              <p class="text-xs text-slate-500">
                Fake data ‚Äì one row per student team.
              </p>
            </div>

            <div class="flex gap-2 text-xs">
              <button
                class="px-3 py-1 rounded-full border border-slate-200 bg-white hover:bg-slate-50"
                data-status-filter="all"
              >
                All
              </button>
              <button
                class="px-3 py-1 rounded-full border border-emerald-200 bg-emerald-50 hover:bg-emerald-100"
                data-status-filter="green"
              >
                Green
              </button>
              <button
                class="px-3 py-1 rounded-full border border-amber-200 bg-amber-50 hover:bg-amber-100"
                data-status-filter="yellow"
              >
                Yellow
              </button>
              <button
                class="px-3 py-1 rounded-full border border-rose-200 bg-rose-50 hover:bg-rose-100"
                data-status-filter="red"
              >
                Red
              </button>
            </div>
          </div>

          <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
            <table class="min-w-full text-sm">
              <thead class="bg-slate-50">
                <tr>
                  <th class="px-3 py-2 text-left text-xs font-semibold text-slate-500">Team ID</th>
                  <th class="px-3 py-2 text-left text-xs font-semibold text-slate-500">Project</th>
                  <th class="px-3 py-2 text-left text-xs font-semibold text-slate-500">Status</th>
                  <th class="px-3 py-2 text-left text-xs font-semibold text-slate-500">
                    Communication
                  </th>
                  <th class="px-3 py-2 text-left text-xs font-semibold text-slate-500">
                    Workload balance
                  </th>
                  <th class="px-3 py-2 text-left text-xs font-semibold text-slate-500">
                    Risk note
                  </th>
                </tr>
              </thead>
              <tbody id="teams-table-body" class="divide-y divide-slate-100">
                <!-- Filled by JS -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- ========== SCREEN: BOT REFLECTION (STUDENT VIEW) ========== -->
        <section id="screen-bot" data-screen class="space-y-4 hidden">
          <div class="grid gap-4 md:grid-cols-[minmax(0,2fr),minmax(0,1fr)] items-start">
            <!-- Chat area -->
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 flex flex-col h-96">
              <div class="border-b border-slate-100 px-4 py-2 flex justify-between items-center">
                <div>
                  <p class="text-sm font-semibold text-slate-800">Reflection bot ‚Äì Team TS-03</p>
                  <p class="text-[11px] text-slate-500">
                    Short weekly conversation (3‚Äì5 questions).
                  </p>
                </div>
                <span class="inline-flex items-center rounded-full bg-emerald-50 border border-emerald-200 px-2 py-1 text-[11px] text-emerald-700">
                  Demo / Fake chat
                </span>
              </div>

              <div id="chat-messages" class="flex-1 overflow-y-auto px-4 py-3 space-y-3 text-sm">
                <!-- Filled by JS -->
              </div>

              <div class="border-t border-slate-100 px-3 py-2 flex items-center gap-2">
                <input
                  id="chat-input"
                  type="text"
                  placeholder="Type a short answer (fake input)‚Ä¶"
                  class="flex-1 border border-slate-200 rounded-full px-3 py-1.5 text-xs focus:outline-none focus:ring-1 focus:ring-indigo-400"
                />
                <button
                  id="chat-send-btn"
                  class="px-3 py-1.5 rounded-full bg-indigo-600 text-xs text-white hover:bg-indigo-700"
                >
                  Send
                </button>
              </div>
            </div>

            <!-- Bot summary ‚Äúfor lecturer‚Äù -->
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4 space-y-3 text-xs">
              <h3 class="text-sm font-semibold text-slate-800">
                Example summary for the lecturer
              </h3>

              <div class="flex items-center gap-2">
                <span class="inline-flex h-3 w-3 rounded-full bg-amber-400"></span>
                <span class="font-medium text-slate-700">Current status: Yellow (medium risk)</span>
              </div>

              <ul class="list-disc list-inside space-y-1 text-slate-600">
                <li>Two team members report unbalanced workload.</li>
                <li>Communication between meetings is described as ‚Äúnot clear enough‚Äù.</li>
                <li>One member feels they are ‚Äúdoing most of the coding‚Äù.</li>
              </ul>

              <div class="border-t pt-2 space-y-1">
                <p class="font-semibold text-slate-800">Suggested actions:</p>
                <ul class="list-disc list-inside space-y-1 text-slate-600">
                  <li>Ask the team to define clear roles for the next sprint.</li>
                  <li>Send them a short exercise about ‚Äúteam agreements‚Äù.</li>
                  <li>Schedule a short 10-minute checkpoint next week if status stays yellow.</li>
                </ul>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
  </div>

  <!-- ===== PURE JS SCRIPT (FAKE DATA + SIMPLE LOGIC) ===== -->
  <script>
    // ----- Fake data for teams -----
    const teams = [
      {
        id: "TS-01",
        project: "IoT Greenhouse Monitoring",
        status: "green",
        communicationScore: 4.5,
        workloadBalance: 4.0,
        riskNote: "Low risk ‚Äì stable collaboration",
      },
      {
        id: "TS-02",
        project: "Smart Campus Navigation",
        status: "yellow",
        communicationScore: 3.0,
        workloadBalance: 2.8,
        riskNote: "Unequal workload reported",
      },
      {
        id: "TS-03",
        project: "TeamInsight ‚Äì Reflection Bot",
        status: "yellow",
        communicationScore: 2.9,
        workloadBalance: 3.2,
        riskNote: "Potential conflict between two members",
      },
      {
        id: "TS-04",
        project: "Health Data Dashboard",
        status: "red",
        communicationScore: 2.1,
        workloadBalance: 2.0,
        riskNote: "Poor communication and late deliverables",
      },
      {
        id: "TS-05",
        project: "Smart Parking Web App",
        status: "green",
        communicationScore: 4.7,
        workloadBalance: 4.6,
        riskNote: "Very good collaboration",
      },
    ];

    // ----- Fake chat messages between bot and students -----
    const initialChatMessages = [
      {
        from: "bot",
        text: "Hi Team TS-03 üëã This is your weekly reflection. I‚Äôll ask 3 short questions.",
      },
      {
        from: "bot",
        text: "Q1: How would you rate the communication inside the team this week?",
      },
      {
        from: "student",
        text: "I think it was okay, but we had some misunderstandings about the tasks.",
      },
      {
        from: "bot",
        text: "Q2: Do you feel the workload is divided fairly between the team members?",
      },
      {
        from: "student",
        text: "Not really, two of us are coding most of the time.",
      },
      {
        from: "bot",
        text: "Q3: Is there any conflict or frustration you‚Äôd like to mention (without names)?",
      },
      {
        from: "student",
        text: "A bit of tension about who decides what goes into the final version.",
      },
    ];

    // ----- Utility: create status pill -----
    function createStatusPill(status) {
      const baseClasses =
        "inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium";
      switch (status) {
        case "green":
          return `<span class="${baseClasses} bg-emerald-50 text-emerald-700 border border-emerald-200">Green</span>`;
        case "yellow":
          return `<span class="${baseClasses} bg-amber-50 text-amber-700 border border-amber-200">Yellow</span>`;
        case "red":
          return `<span class="${baseClasses} bg-rose-50 text-rose-700 border border-rose-200">Red</span>`;
        default:
          return `<span class="${baseClasses} bg-slate-50 text-slate-700 border border-slate-200">${status}</span>`;
      }
    }

    // ----- Render teams table -----
    function renderTeamsTable(filterStatus = "all") {
      const tbody = document.getElementById("teams-table-body");
      tbody.innerHTML = "";

      const filtered =
        filterStatus === "all"
          ? teams
          : teams.filter((t) => t.status === filterStatus);

      filtered.forEach((team) => {
        const tr = document.createElement("tr");
        tr.className = "hover:bg-slate-50";

        tr.innerHTML = `
          <td class="px-3 py-2 text-xs text-slate-700">${team.id}</td>
          <td class="px-3 py-2 text-xs text-slate-700">${team.project}</td>
          <td class="px-3 py-2 text-xs">${createStatusPill(team.status)}</td>
          <td class="px-3 py-2 text-xs text-slate-700">${team.communicationScore.toFixed(
            1
          )} / 5</td>
          <td class="px-3 py-2 text-xs text-slate-700">${team.workloadBalance.toFixed(
            1
          )} / 5</td>
          <td class="px-3 py-2 text-xs text-slate-600">${team.riskNote}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // ----- Update KPI cards + bars -----
    function updateKpisAndBars() {
      const total = teams.length;
      const green = teams.filter((t) => t.status === "green").length;
      const yellow = teams.filter((t) => t.status === "yellow").length;
      const red = teams.filter((t) => t.status === "red").length;

      document.getElementById("kpi-total-teams").textContent = total;
      document.getElementById("kpi-green-teams").textContent = green;
      document.getElementById("kpi-yellow-teams").textContent = yellow;
      document.getElementById("kpi-red-teams").textContent = red;

      function percent(x) {
        return total === 0 ? 0 : Math.round((x / total) * 100);
      }

      const greenP = percent(green);
      const yellowP = percent(yellow);
      const redP = percent(red);

      document.getElementById("label-green-percent").textContent =
        greenP + "%";
      document.getElementById("label-yellow-percent").textContent =
        yellowP + "%";
      document.getElementById("label-red-percent").textContent = redP + "%";

      document.getElementById("bar-green").style.width = greenP + "%";
      document.getElementById("bar-yellow").style.width = yellowP + "%";
      document.getElementById("bar-red").style.width = redP + "%";
    }

    // ----- Nav between screens -----
    function setupNavigation() {
      const screens = document.querySelectorAll("[data-screen]");
      const navButtons = document.querySelectorAll("[data-nav-btn]");

      function showScreen(id) {
        screens.forEach((section) => {
          section.classList.toggle("hidden", section.id !== id);
        });
        navButtons.forEach((btn) => {
          const target = btn.getAttribute("data-target");
          btn.setAttribute("data-active", target === id);
        });
      }

      navButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const targetId = btn.getAttribute("data-target");
          showScreen(targetId);
        });
      });

      // default screen
      showScreen("screen-dashboard");
    }

    // ----- Status filter buttons -----
    function setupStatusFilters() {
      const filterButtons = document.querySelectorAll("[data-status-filter]");
      filterButtons.forEach((btn) => {
        btn.addEventListener("click", () => {
          const status = btn.getAttribute("data-status-filter");
          renderTeamsTable(status);
        });
      });
    }

    // ----- Chat rendering / fake interaction -----
    function renderChatMessages(messages) {
      const container = document.getElementById("chat-messages");
      container.innerHTML = "";

      messages.forEach((msg) => {
        const wrapper = document.createElement("div");
        const isBot = msg.from === "bot";

        wrapper.className = `flex ${
          isBot ? "justify-start" : "justify-end"
        }`;

        const bubble = document.createElement("div");
        bubble.className =
          "max-w-[80%] px-3 py-2 rounded-2xl text-xs shadow-sm " +
          (isBot
            ? "bg-slate-100 text-slate-800 rounded-bl-sm"
            : "bg-indigo-600 text-white rounded-br-sm");

        bubble.textContent = msg.text;
        wrapper.appendChild(bubble);
        container.appendChild(wrapper);
      });

      container.scrollTop = container.scrollHeight;
    }

    function setupChat() {
      const chatMessages = [...initialChatMessages]; // copy
      const input = document.getElementById("chat-input");
      const sendBtn = document.getElementById("chat-send-btn");

      renderChatMessages(chatMessages);

      function sendMessage() {
        const text = input.value.trim();
        if (!text) return;

        chatMessages.push({ from: "student", text });
        // Fake bot auto-reply (for demo only)
        chatMessages.push({
          from: "bot",
          text: "Thanks, I recorded your answer. (Demo only ‚Äì no real NLP yet)",
        });

        input.value = "";
        renderChatMessages(chatMessages);
      }

      sendBtn.addEventListener("click", sendMessage);
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          sendMessage();
        }
      });
    }

    // ----- Initialize all when DOM is ready -----
    document.addEventListener("DOMContentLoaded", () => {
      renderTeamsTable("all");
      updateKpisAndBars();
      setupNavigation();
      setupStatusFilters();
      setupChat();
    });
  </script>
</body>
</html>
